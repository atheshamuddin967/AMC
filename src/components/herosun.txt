import { useEffect, useRef } from "react";
import { Button } from "@/components/ui/button";
import { ChevronRight } from "lucide-react";
import gsap from "gsap";
import { ScrollTrigger } from "gsap/ScrollTrigger";

gsap.registerPlugin(ScrollTrigger);

export const HeroSection = () => {
  const heroRef = useRef(null);
  const sunRef = useRef(null);
  const titleRef = useRef(null);
  const subtitleRef = useRef(null);
  const buttonsRef = useRef(null);

  useEffect(() => {
    const ctx = gsap.context(() => {
      const tl = gsap.timeline({ defaults: { ease: "power3.out" } });

      // ğŸŒ„ Sun slides in smoothly from left (once)
      tl.fromTo(
        sunRef.current,
        { x: -200, y: 100, opacity: 0.5, scale: 0.8, filter: "brightness(0.6)" },
        {
          x: 0,
          y: 0,
          opacity: 1,
          scale: 1,
          duration: 2.5,
          filter: "brightness(1.5)",
          ease: "power2.out",
        }
      );

      // â˜€ï¸ Continuous sunlight flicker (brightness + slight scale)
      gsap.to(sunRef.current, {
        scale: 1.05,
        filter: "brightness(2)",
        duration: 3,
        repeat: -1,
        yoyo: true,
        ease: "sine.inOut",
      });

      // âœï¸ Text animations
      tl.from(titleRef.current, { y: 50, opacity: 0, duration: 1 }, "-=0.5")
        .from(subtitleRef.current, { y: 30, opacity: 0, duration: 1 }, "-=0.6")
        .from(buttonsRef.current, { y: 20, opacity: 0, duration: 1 }, "-=0.6");
    }, heroRef);

    return () => ctx.revert();
  }, []);

  return (
    <section
      ref={heroRef}
      className="relative h-screen flex items-center justify-center overflow-hidden bg-gradient-to-b from-sky-200 via-blue-100 to-amber-100"
    >
      {/* ğŸŒ‡ Static Solar Panel Image */}
      <div
        className="absolute inset-0 z-[1] bg-[url('https://images.unsplash.com/photo-1508514177221-188b1cf16e9d?w=1920')] 
        bg-cover bg-center brightness-[0.95]"
      ></div>

      {/* â˜€ï¸ Sun (moves in & stays) */}
      <div
        ref={sunRef}
        className="absolute top-[25%] left-[15%] z-[5] w-[280px] h-[280px] rounded-full 
        bg-[radial-gradient(circle,rgba(255,255,240,1)_0%,rgba(255,245,130,1)_35%,rgba(255,179,0,1)_70%,rgba(255,102,0,0.9)_100%)]
        shadow-[0_0_200px_80px_rgba(255,200,0,0.4)] pointer-events-none"
      ></div>

      {/* Light overlay for realism */}
      <div className="absolute inset-0 bg-gradient-to-t from-white/70 via-transparent to-transparent z-[2]"></div>

      {/* ğŸ–‹ï¸ Text Content (dark background for contrast) */}
      <div className="relative z-[10] text-center px-6 max-w-5xl mx-auto">
        <div className="bg-black/50 backdrop-blur-sm inline-block rounded-2xl px-8 py-10 shadow-xl">
          <h1
            ref={titleRef}
            className="text-5xl md:text-7xl font-bold text-white mb-6 leading-tight drop-shadow-lg"
          >
            Building the Future â€”{" "}
            <span className="text-yellow-400">Powering Sustainability</span>
          </h1>
          <p
            ref={subtitleRef}
            className="text-xl md:text-2xl text-gray-200 mb-10 max-w-3xl mx-auto"
          >
            From Construction to Renewable Energy â€” AMC empowers progress with
            innovation and excellence.
          </p>
          <div
            ref={buttonsRef}
            className="flex flex-col sm:flex-row gap-4 justify-center"
          >
            <Button
              size="lg"
              className="bg-yellow-500 hover:bg-yellow-400 text-slate-900 font-semibold px-8 py-6 text-lg"
            >
              Explore Our Services <ChevronRight className="ml-2" />
            </Button>
            <Button
              size="lg"
              className="bg-slate-700 hover:bg-slate-600 text-white px-8 py-6 text-lg"
            >
              View Projects
            </Button>
          </div>
        </div>
      </div>

      {/* Scroll Indicator */}
      <div className="absolute bottom-10 left-1/2 -translate-x-1/2 animate-bounce z-[15]">
        <ChevronRight className="rotate-90 text-white w-8 h-8" />
      </div>
    </section>
  );
};
